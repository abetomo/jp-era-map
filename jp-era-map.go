package jperamap

import (
	"golang.org/x/text/width"
)

var JpEraMap = map[string]int{
	"M01": 1868,
	"M02": 1869,
	"M03": 1870,
	"M04": 1871,
	"M05": 1872,
	"M06": 1873,
	"M07": 1874,
	"M08": 1875,
	"M09": 1876,
	"M10": 1877,
	"M11": 1878,
	"M12": 1879,
	"M13": 1880,
	"M14": 1881,
	"M15": 1882,
	"M16": 1883,
	"M17": 1884,
	"M18": 1885,
	"M19": 1886,
	"M20": 1887,
	"M21": 1888,
	"M22": 1889,
	"M23": 1890,
	"M24": 1891,
	"M25": 1892,
	"M26": 1893,
	"M27": 1894,
	"M28": 1895,
	"M29": 1896,
	"M30": 1897,
	"M31": 1898,
	"M32": 1899,
	"M33": 1900,
	"M34": 1901,
	"M35": 1902,
	"M36": 1903,
	"M37": 1904,
	"M38": 1905,
	"M39": 1906,
	"M40": 1907,
	"M41": 1908,
	"M42": 1909,
	"M43": 1910,
	"M44": 1911,
	"M45": 1912,

	"T01": 1912,
	"T02": 1913,
	"T03": 1914,
	"T04": 1915,
	"T05": 1916,
	"T06": 1917,
	"T07": 1918,
	"T08": 1919,
	"T09": 1920,
	"T10": 1921,
	"T11": 1922,
	"T12": 1923,
	"T13": 1924,
	"T14": 1925,
	"T15": 1926,

	"S01": 1926,
	"S02": 1927,
	"S03": 1928,
	"S04": 1929,
	"S05": 1930,
	"S06": 1931,
	"S07": 1932,
	"S08": 1933,
	"S09": 1934,
	"S10": 1935,
	"S11": 1936,
	"S12": 1937,
	"S13": 1938,
	"S14": 1939,
	"S15": 1940,
	"S16": 1941,
	"S17": 1942,
	"S18": 1943,
	"S19": 1944,
	"S20": 1945,
	"S21": 1946,
	"S22": 1947,
	"S23": 1948,
	"S24": 1949,
	"S25": 1950,
	"S26": 1951,
	"S27": 1952,
	"S28": 1953,
	"S29": 1954,
	"S30": 1955,
	"S31": 1956,
	"S32": 1957,
	"S33": 1958,
	"S34": 1959,
	"S35": 1960,
	"S36": 1961,
	"S37": 1962,
	"S38": 1963,
	"S39": 1964,
	"S40": 1965,
	"S41": 1966,
	"S42": 1967,
	"S43": 1968,
	"S44": 1969,
	"S45": 1970,
	"S46": 1971,
	"S47": 1972,
	"S48": 1973,
	"S49": 1974,
	"S50": 1975,
	"S51": 1976,
	"S52": 1977,
	"S53": 1978,
	"S54": 1979,
	"S55": 1980,
	"S56": 1981,
	"S57": 1982,
	"S58": 1983,
	"S59": 1984,
	"S60": 1985,
	"S61": 1986,
	"S62": 1987,
	"S63": 1988,
	"S64": 1989,

	"H01": 1989,
	"H02": 1990,
	"H03": 1991,
	"H04": 1992,
	"H05": 1993,
	"H06": 1994,
	"H07": 1995,
	"H08": 1996,
	"H09": 1997,
	"H10": 1998,
	"H11": 1999,
	"H12": 2000,
	"H13": 2001,
	"H14": 2002,
	"H15": 2003,
	"H16": 2004,
	"H17": 2005,
	"H18": 2006,
	"H19": 2007,
	"H20": 2008,
	"H21": 2009,
	"H22": 2010,
	"H23": 2011,
	"H24": 2012,
	"H25": 2013,
	"H26": 2014,
	"H27": 2015,
	"H28": 2016,
	"H29": 2017,
	"H30": 2018,
	"H31": 2019,

	"R01": 2019,
	"R02": 2020,
	"R03": 2021,
	"R04": 2022,
	"R05": 2023,
	"R06": 2024,
	"R07": 2025,
	"R08": 2026,
	"R09": 2027,
	"R10": 2028,
	"R11": 2029,
	"R12": 2030,
	"R13": 2031,
	"R14": 2032,
	"R15": 2033,
	"R16": 2034,
	"R17": 2035,
	"R18": 2036,
	"R19": 2037,
	"R20": 2038,
	"R21": 2039,
	"R22": 2040,
	"R23": 2041,
	"R24": 2042,
	"R25": 2043,
	"R26": 2044,
	"R27": 2045,
	"R28": 2046,
	"R29": 2047,
	"R30": 2048,
	"R31": 2049,
	"R32": 2050,
	"R33": 2051,
	"R34": 2052,
	"R35": 2053,
	"R36": 2054,
	"R37": 2055,
	"R38": 2056,
	"R39": 2057,
	"R40": 2058,
	"R41": 2059,
	"R42": 2060,
	"R43": 2061,
	"R44": 2062,
	"R45": 2063,
	"R46": 2064,
	"R47": 2065,
	"R48": 2066,
	"R49": 2067,
	"R50": 2068,
}

func JpEra(wareki string) int {
	chars := []rune(wareki)
	if len(chars) < 3 {
		return 0
	}

	n := (func() string {
		if chars[len(chars)-1] == '年' {
			n := "0" + width.Narrow.String(string(chars[2:len(chars)-1]))
			return n[len(n)-2:]
		}
		return string(chars[1:])
	})()

	switch chars[0] {
	case '1':
		return JpEraMap["M"+n]
	case '2':
		return JpEraMap["T"+n]
	case '3':
		return JpEraMap["S"+n]
	case '4':
		return JpEraMap["H"+n]
	case '5':
		return JpEraMap["R"+n]

	case '明':
		return JpEraMap["M"+n]
	case '大':
		return JpEraMap["T"+n]
	case '昭':
		return JpEraMap["S"+n]
	case '平':
		return JpEraMap["H"+n]
	case '令':
		return JpEraMap["R"+n]
	}
	return JpEraMap[wareki]
}
